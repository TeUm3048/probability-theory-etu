\problemset{Теория вероятностей и математическая статистика}
\problemset{Индивидуальное домашнее задание №1}	% поменяйте номер ИДЗ

\renewcommand*{\proofname}{Решение}

%%%%%%%%%%%%%% ЗАДАНИЕ №1 %%%%%%%%%%%%%%
%% Условие задания №1
\begin{problem}
Найти вероятность того, что среди 8 выбранных наудачу цифр будут представлены ровно 2 различных цифры.
\end{problem}

%% Решение задания №1
\begin{proof} (Исправлено)
	Множество всех исходов \(\Omega \) представляет собой все размещения с повторениями из 10 цифр по 8 позициям. Тогда \(\#\Omega = 10^8\). Пусть \(A\) "--- событие, что среди 8 выбранных наудачу цифр будут представлены ровно 2 различных цифры.

	Выберем цифру $a$ и зафиксируем, это можно сделать $10$ способами, зафиксируем её на первой позиции. Выберем вторую цифру $b$, которая будет отличаться от первой, это можно сделать $9$ способами, но не будем фиксировать её на определенной позиции.

	\[
		a \Box  \Box  \Box  \Box  \Box  \Box  \Box
	\]

	Вместо этого расположим произвольным образом цифры $a$ и $b$ на оставшихся $7$ позициях. Это можно сделать $2^7$ способами.

	\[
		\begin{tabular}{c}
			aaaaaaaa \\
			aaaaaaab \\
			aaaaaaba \\
			aaaaaabb \\
			\ldots   \\
			abbbbbba \\
			abbbbbbb \\
		\end{tabular}
	\]

	Заметим, что одна из перечисленных последовательностей одна нам не подходит \(aaaaaaaa\).

	Тогда итоговое число благоприятных исходов равно

	\[
		\#A = 10 \cdot 9 \cdot (2^7 - 1) = 10 \cdot 9 \cdot 127 = 11430.
	\]

	Таким образом, вероятность наступления события \(A\) равна

	\[
		\Prob A = \cfrac{\#A}{\#\Omega} = \cfrac{11430}{10^8} = 0,0001143.
	\]

	Ответ: \(\Prob A = 0,0001143\).

	% Пусть $ A $ "--- событие, что достали белый шар.
	% Количество всех исходов будет равно: $ \#\Omega \hm= K + L $.

	% Тогда количество благоприятных исходов (наступления события $ A $) равно: $ \#A = K $.

	% Отсюда получаем, что вероятность наступления события $ A $ равна:
	% \[ \Prob A = \cfrac{\#A}{\#\Omega} = \cfrac{K}{K + L}. \]
\end{proof}

%%%%%%%%%%%%%% ЗАДАНИЕ №2 %%%%%%%%%%%%%%
%% Условие задания №2
\begin{problem}
На плоскости расчерчена прямоугольная сетка. Величина каждой ячейки равна $9\times6$ ед. Определить вероятность того, что монета диаметра 3, наугад брошенная на плоскость, не пересечёт ни одной прямой.
% Распределение случайной величины $ \xi $ задано таблицей:
% \begin{center}
% 	\begin{tabular}{|c|c|c|c|c|c|}
% 		\hline
% 		$ \xi $        & 1   & 2   & 4   & 6   & $ \Sigma $ \\
% 		\hline
% 		$ \mathbb{P} $ & 0,1 & 0,2 & 0,6 & 0,1 & 1          \\
% 		\hline
% 	\end{tabular}
% \end{center}
% Вычислить $ \Expect\xi $, $ \Variance\xi $, $ \Entropy\xi $ (в натах) и распределение $ \eta = \sin(\pi\xi/3) $.
\end{problem}

%% Решение задания №2
\begin{proof}
	Уточним, что значит, наугад брошенная монета. Пусть монета падает равномерно по всей плоскости, т.е. для любых двух областей на плоскости с равной площадью вероятность попадания в них центра монеты одинакова. Тогда решение будет таким.

	Так как каждая ячейка сетки имеет размер $9\times6$ ед., то монета диаметра 3 не пересечёт ни одной прямой, если монета будет находится внутри ячейки не касаясь её границ. Тогда вероятность того, что монета не пересечёт ни одной прямой, равна отношению площади области, где монета не касается края ячейки к площади ячейки:
	\[
		\Prob A = \cfrac{6 \cdot 3}{9 \cdot 6} = \cfrac{1}{3}.
	\]
	\[
		\begin{tikzpicture}
			\draw[color=lightgray] (-0.5, -0.5) grid (9.5, 6.5);

			% Draw the outer rectangle
			\draw (0, 0) rectangle (9, 6);

			% Draw the inner region
			\draw[pattern=north west lines, pattern color=gray!70, densely dashed] ([shift={(1.5, 1.5)}]0, 0) rectangle ([shift={(-1.5, -1.5)}]9, 6);
			\node at (4.5, 3) {A};

			% Add dimensions of each region
			\node at (9.25, 3) {6};
			\node at (4.5, -0.25) {9};
			\node at (1.25, 3) {3};
			\node at (4.5, 4.75) {6};

			% Draw some coins
			\draw[color=olive!50] (7,1) circle (1.5);
			\draw[color=olive!50] (2.5,4) circle (1.5);
			\draw[color=olive!50] (6.5,4.5) circle (1.5);

			% Add distance from edges
			\draw[<->] (0, 1.75) -- (1.5, 1.75) node[midway, above] {1.5};
			\draw[<->] (1.75, 0) -- (1.75, 1.5) node[midway, right] {1.5};
		\end{tikzpicture}
	\]
	% Математическое ожидание дискретной случайной величины $ \xi $ задаётся формулой:
	% \[ \Expect\xi = \sum_{i \colon p_i > 0}a_ip_i. \]
	% Отсюда получаем:
	% \[ \Expect\xi = 1 \cdot 0,1 + 2 \cdot 0,2 + 4 \cdot 0,6 + 6 \cdot 0,1 = 3,5. \]
	% Дисперсия дискретной случайной величины $ \xi $ задаётся формулой:
	% \[ \Variance\xi = \sum_{i \colon p_i > 0}(a_i - \mathbb E\xi)^2p_i. \]
	% Отсюда получаем:
	% \[ \Variance\xi = (1 - 3,5)^2 \cdot 0,1 + (2 - 3,5)^2 \cdot 0,2 + (4 - 3,5)^2 \cdot 0,6 + (6 - 3,5)^2 \cdot 0,1 = 1,85. \]
	% Энтропия дискретной случайной величины $ \xi $ задаётся формулой:
	% \[ \Entropy\xi = -\sum_{i \colon p_i > 0}p_i\log_bp_i. \]
	% Необходимо вычислить энтропию в натах, т~е. $ b = e $. Получим:
	% \[ \Entropy\xi = -(0,1 \cdot \ln0,1 + 0,2 \cdot \ln0,2 + 0,6 \cdot \ln0,6 + 0,1 \cdot \ln0,1) \approx 1,0889. \]
	% Носитель случайной величины $ \xi $ имеет вид: $ \supp \xi = \lbrace 1, 2, 4, 6 \rbrace $. Тогда носитель случайной величины $ \eta $ будет иметь вид: $ \supp \eta = \left\lbrace -\frac{\sqrt{3}}{2}, 0, \frac{\sqrt{3}}{2} \right\rbrace  $. Найдём вероятности появления каждого числа:
	% \begin{align*}
	% 	\Prob(\eta = -\sqrt{3}/2) & = \Prob(\xi = 4) = 0,6.                  \\
	% 	\Prob(\eta = 0)           & = \Prob(\xi = 6) = 0,1.                  \\
	% 	\Prob(\eta = \sqrt{3}/2)  & = \Prob(\xi = 1) + \Prob(\xi = 2) = 0,3.
	% \end{align*}
	% Таким образом, можно записать распределение случайной величины $ \eta $ в виде таблицы:
	% \begin{center}
	% 	\begin{tabular}{|c|c|c|c|c|}
	% 		\hline
	% 		$ \eta $  & $ -\sqrt{3}/2 $ & 0   & $ \sqrt{3}/2 $ & $ \Sigma $ \\ \hline
	% 		$ \Prob $ & 0,6             & 0,1 & 0,3            & 1          \\ \hline
	% 	\end{tabular}
	% \end{center}
\end{proof}

%%%%%%%%%%%%%% ЗАДАНИЕ №3 %%%%%%%%%%%%%%
%% Условие задания №3
\begin{problem}
В первой урне находится 18 белых и 10 чёрных шаров; во второй -8 белых и 16 чёрных шаров. Одновременно из первой во вторую урну наугад перекладывают 2 шара; из второй урны в первую перекладывают 3 шара. Затем из второй урны достают шар. Он белый. Определить вероятность того, что в первой урне осталось столько же белых шаров, сколько было вначале.
\end{problem}

%% Решение задания №3
\begin{proof}
	Рассмотрим такую полную группу решений: \(H_{0}\) "--- событие, что в первой урне осталось столько же белых шаров, сколько было вначале. \(H_{+1\text{б}}\) "--- событие, что в первой урне осталось на один белый шар больше, чем было вначале. \(H_{+2\text{б}}\) "--- событие, что в первой урне осталось на два белых шара больше, чем было вначале.
	\(H_{-1\text{б}}\), \(H_{-2\text{б}}\) "--- события, что в первой урне осталось на один и два белых шара меньше соответвенно, чем было вначале.

	Событие \(A\) "--- событие, что из второй урны достали белый шар. Тогда вероятность, которую требуется найти "--- это \(\Prob(H_{0} | A)\).
	\renewcommand{\arraystretch}{1.5} % Increase the height of the rows by 1.5 times
	\[
		\begin{tabular}{|c|c|c|c|c|c|c|c|}
			\hline
			\(i\)               & \(0\)            &
			\(+1\text{б}\)      & \(+2\text{б}\)   &
			\(+3\text{б}\)      & \(-1\text{б}\)   &
			\(-2\text{б}\)      & \(\Sigma\)         \\
			\hline
			\(\Prob H_{i}\)     & ...              &
			...                 & ...              &
			...                 & ...              &
			...                 & \(1\)              \\
			\hline
			\(\Prob(A | H_i)\)  & \(\frac{8}{23}\) &
			\(\frac{7}{23}\)    & \(\frac{6}{23}\) &
			\(\frac{5}{23}\)    & \(\frac{9}{23}\) &
			\(\frac{10}{23}\)   & ---                \\
			\hline
			\(\Prob( H_i | A)\) & ?                &
			...                 & ...              &
			...                 & ...              &
			...                 & ---                \\
			\hline
		\end{tabular}
	\]
	\renewcommand{\arraystretch}{1} % Reset to default

	Найдем вероятности каждого из событий \(H_i\):

	Рассмотрим эксперемент, когда мы в первый раз достаём шары из корзины, перед тем как переложить их.

	Всего элементарных исходов достать 2 шара из первой корзины (28 шаров) и 3 шара из второй корзины (24 шара) равно \(\#\Omega_1 = \binom{28}{2} \cdot \binom{24}{3}\) = 765072.

	Событие \(H_i\) обозначает, что мы взяли из второй корзина на \(i\) белых шаров больше.

	\[
		\begin{tabular}{|c|c|c|c|c|}
			\hline
			\diagbox{2 корзина}{1 корзина} &
			чч                             & чб             &
			бч                             & бб               \\
			\hline
			ччч                            &
			\(0\)                          & \(-1\text{б}\) &
			\(-1\text{б}\)                 & \(-2\text{б}\)   \\
			\hline
			ччб                            &
			\(+1\text{б}\)                 & \(0\)          &
			\(0\)                          & \(-1\text{б}\)   \\
			\hline
			чбч                            &
			\(+1\text{б}\)                 & \(0\)          &
			\(0\)                          & \(-1\text{б}\)   \\
			\hline
			бчч                            &
			\(+1\text{б}\)                 & \(0\)          &
			\(0\)                          & \(-1\text{б}\)   \\
			\hline
			чбб                            &
			\(+2\text{б}\)                 & \(+1\text{б}\) &
			\(+1\text{б}\)                 & \(0\)            \\
			\hline
			бчб                            &
			\(+2\text{б}\)                 & \(+1\text{б}\) &
			\(+1\text{б}\)                 & \(0\)            \\
			\hline
			ббч                            &
			\(+2\text{б}\)                 & \(+1\text{б}\) &
			\(+1\text{б}\)                 & \(0\)            \\
			\hline
			ббб                            &
			\(+3\text{б}\)                 & \(+2\text{б}\) &
			\(+2\text{б}\)                 & \(+1\text{б}\)   \\
			\hline
		\end{tabular}
	\]

	\(\# H_0 =\) количеству способов выбрать \(0\) \textit{белых} из I корзины и \(0\) \textit{белых} из II, плюс \(1\)\textit{б} из I и \(1\)\textit{б} из II, плюс \(2\)\textit{б} из I и \(2\)\textit{б} из II.

	\[
		\begin{aligned}
			 & \# H_0            & =\  &
			\binom{18}{0} \cdot \binom{10}{2} \cdot \binom{8}{0} \cdot \binom{16}{3} +
			\binom{18}{1} \cdot \binom{10}{1} \cdot \binom{8}{1} \cdot \binom{16}{2} +
			\binom{18}{2} \cdot \binom{10}{0} \cdot \binom{8}{2} \cdot \binom{16}{1} = 266544.
			\\
			 & \# H_{+1\text{б}} & =\  &
			\binom{18}{0} \cdot \binom{10}{2} \cdot \binom{8}{1} \cdot \binom{16}{2} +
			\binom{18}{1} \cdot \binom{10}{1} \cdot \binom{8}{2} \cdot \binom{16}{1} +
			\binom{18}{2} \cdot \binom{10}{0} \cdot \binom{8}{3} \cdot \binom{16}{0} = 132408.
			\\
			 & \# H_{+2\text{б}} & =\  &
			\binom{18}{0} \cdot \binom{10}{2} \cdot \binom{8}{2} \cdot \binom{16}{1} +
			\binom{18}{1} \cdot \binom{10}{1} \cdot \binom{8}{3} \cdot \binom{16}{0} = 30240.
			\\
			 & \# H_{+3\text{б}} & =\  &
			\binom{18}{0} \cdot \binom{10}{2} \cdot \binom{8}{3} \cdot \binom{16}{0} = 2520.
			\\
			 & \# H_{-1\text{б}} & =\  &
			\binom{18}{1} \cdot \binom{10}{1} \cdot \binom{8}{0} \cdot \binom{16}{3} +
			\binom{18}{2} \cdot \binom{10}{0} \cdot \binom{8}{1} \cdot \binom{16}{2} = 247680.
			\\
			 & \# H_{-2\text{б}} & =\  &
			\binom{18}{2} \cdot \binom{10}{0} \cdot \binom{8}{0} \cdot \binom{16}{3}  = 85680.
		\end{aligned}
	\]

	Вероятности каждого из этих событий
	\[
		\begin{aligned}
			 & \Prob H_0            & = \frac{\# H_0}{\#\Omega_1} = \frac{266544}{765072}  \approx 0,34839,           \\
			 & \Prob H_{+1\text{б}} & = \frac{\# H_{+1\text{б}}}{\#\Omega_1} = \frac{132408}{765072} \approx 0,17307, \\
			 & \Prob H_{+2\text{б}} & = \frac{\# H_{+2\text{б}}}{\#\Omega_1} = \frac{30240}{765072}  \approx 0,03952, \\
			 & \Prob H_{+3\text{б}} & = \frac{\# H_{+3\text{б}}}{\#\Omega_1} = \frac{2520}{765072}   \approx 0,00329, \\
			 & \Prob H_{-1\text{б}} & = \frac{\# H_{-1\text{б}}}{\#\Omega_1} = \frac{247680}{765072} \approx 0,32373, \\
			 & \Prob H_{-2\text{б}} & = \frac{\# H_{-2\text{б}}}{\#\Omega_1} = \frac{85680}{765072} \approx 0,11198,  \\
		\end{aligned}
	\]

	Дополним таблицу вероятностями событий \(H_i\):

	\renewcommand{\arraystretch}{1.5} % Increase the height of the rows by 1.5 times
	\[
		\begin{tabular}{|c|c|c|c|c|c|c|c|}
			\hline
			\(i\)               & \(0\)            &
			\(+1\text{б}\)      & \(+2\text{б}\)   &
			\(+3\text{б}\)      & \(-1\text{б}\)   &
			\(-2\text{б}\)      & \(\Sigma\)         \\
			\hline
			\(\Prob H_{i}\)     & \(0.34839\)      &
			\(0.17307\)         & \(0.03952\)      &
			\(0.00329\)         & \(0.32373\)      &
			\(0.11198\)         & \(1\)              \\
			\hline
			\(\Prob(A | H_i)\)  & \(\frac{8}{23}\) &
			\(\frac{7}{23}\)    & \(\frac{6}{23}\) &
			\(\frac{5}{23}\)    & \(\frac{9}{23}\) &
			\(\frac{10}{23}\)   & ---                \\
			\hline
			\(\Prob( H_i | A)\) & ?                &
			...                 & ...              &
			...                 & ...              &
			...                 & ---                \\
			\hline
		\end{tabular}
	\]
	\renewcommand{\arraystretch}{1} % Reset to default


	% Каждое из событий может быть представлено в виде совокупности независимых событий



	Теперь найдем вероятность события \(A\) по формуле полной вероятности:

	\[
		\begin{aligned}
			\Prob A & = \sum_{i} \Prob H_i \cdot \Prob(A | H_i) =
			\\
			        & = 0,34839 \cdot \frac{8}{23} + 0,17307 \cdot \frac{7}{23} + 0,03952 \cdot \frac{6}{23} + 0,00329 \cdot \frac{5}{23} + 0,32373 \cdot \frac{9}{23} + 0,11198 \cdot \frac{10}{23} =
			\\
			        & = 0,36024.
		\end{aligned}
	\]
	Тогда искомая вероятность события \(H_{0} | A\) равна по теореме Байеса:
	\[
		\Prob(H_{0} | A) = \frac{\Prob H_{0} \cdot \Prob(A | H_{0})}{\Prob A} =
		\frac{0,34839 \cdot \frac{8}{23}}{0,36024} = 0,3364.
	\]
	Ответ: \(\Prob(H_{0} | A) \approx 0,3364\).
\end{proof}

%%%%%%%%%%%%%% ЗАДАНИЕ №4 %%%%%%%%%%%%%%
%% Условие задания №4
\begin{problem}
Четыре станции независимо друг от друга посылают на спутник сообщение, состоящее из 5-ти символов. Вероятность искажения каждого символа, независимо от другихравна 0.2. В случае получения хотя бы одного неискажённого сообщения спутник посылает ответ, состоящий из З-х символов. При этом вероятность искажения каждого символа равна 0.5. Определить вероятность того, что хотя бы одна из станций получит полностью ответное сообщение.
\end{problem}

%% Решение задания №4
\begin{proof}
	Пусть \(B_i\) "--- событие, что \(i\)-я станция отправит сообщение без ошибок. \(A_i\) "--- событие, что \(i\)-я станция получит ответное сообщение без ошибок.

	Тогда вероятность того, что \(i\)-я станция отправит сообщение без ошибок равна \(\Prob(B_i) = 0.8^5 = 0.32768\).

	Вероятность того, что \(i\)-я станция получит ответное сообщение без ошибок при условии, что она отправила сообщение без ошибок, равна \(\Prob(A_i | B_i) = 0.5^3 = 0.125\).

	Тогда вероятность того, что \(i\)-я станция получит ответное сообщение без ошибок равна \(\Prob(A_i) = \Prob(A_i | B_i) \cdot \Prob(B_i) = 0.125 \cdot 0.32768 = 0.04096\).

	Тогда вероятность события, что хотя бы одна из станций получит полностью ответное сообщение равна
	\[
		\begin{aligned}
			  & \Prob (\mu_4 \geq 1)
			= \sum_{i=1}^{4} \binom{4}{i}\cdot 0,04096^i \cdot (1-0,04096)^{4-i} =
			\\
			= & 1 - \Prob(\mu_4 = 0)  = 1 - \binom{4}{0} \cdot 0,04096^0 \cdot (1-0,04096)^4
			= 1 - 0,95904^4 \approx 0,1540
			\\                                                 \\
		\end{aligned}
	\]
	Ответ: \(\Prob (\mu_4 \geq 1) \approx 0,1540\).
\end{proof}

%%%%%%%%%%%%%% ЗАДАНИЕ №5 %%%%%%%%%%%%%%
%% Условие задания №5
\begin{problem}
Вероятность успеха в схеме Бернулли равна \(1/1500\). Проводится \(2000\) испытаний. Написать точную формулу и вычислить приближённо вероятность того, что число успехов не превышает \(3\).
\end{problem}

%% Решение задания №5
\begin{proof}
	\[
		\begin{aligned}
			p & = \frac{1}{1500} \\
			n & = 2000           \\
		\end{aligned}
	\]
	\[
		\begin{aligned}
			\Prob\left(\mu_{2000} \leq  3\right) &
			= \sum_{k=0}^{3} P_{2000}(k)
			= \sum_{k=0}^{3} \binom{2000}{k} p^k \left(1-p\right)^{2000-k} =
			\\
			                                     &
			= \frac{2000!}{0! \cdot 2000!} \left(\frac{1}{1500}\right)^0 \left(1-\frac{1}{1500}\right)^{2000} +
			\frac{2000!}{1! \cdot 1999!} \left(\frac{1}{1500}\right)^1 \left(1-\frac{1}{1500}\right)^{1999} +
			\\
			                                     &
			+ \frac{2000!}{2! \cdot 1998!} \left(\frac{1}{1500}\right)^2 \left(1-\frac{1}{1500}\right)^{1998} +
			\frac{2000!}{3! \cdot 1997!} \left(\frac{1}{1500}\right)^3 \left(1-\frac{1}{1500}\right)^{1997}
			\\
		\end{aligned}
	\]
	Вычислим это значение приближённо. Воспользуемся формулой схемой Пуассона, т.к. \(np=2000 \cdot \frac{1}{1500} = \frac{4}{3} < 10\)
	\[
		P_n(k) \approx \frac{\lambda^k}{k!} \exp(-\lambda), \text{ где } \lambda = np
	\]
	Тогда \(\lambda = np = \frac{4}{3}\), и
	\[
		\begin{aligned}
			\Prob\left(\mu_{2000} \leq  3\right) &
			\approx \frac{\lambda^0}{0!} \exp(-\lambda) +
			\frac{\lambda^1}{1!} \exp(-\lambda) +
			\frac{\lambda^2}{2!} \exp(-\lambda) +
			\frac{\lambda^3}{3!} \exp(-\lambda) =
			\\
			                                     &
			=  \left(1 + \frac{4}{3} + \frac{16}{9 \cdot 2} + \frac{64}{27 \cdot 6}\right) \exp\left(-\frac{4}{3}\right) \approx 0,9535.
		\end{aligned}
	\]

	Ответ: \(\Prob\left(\mu_{2000} \leq  3\right) \approx 0,9535\).

	Для сравнения найдём значение используя схему Муавра-Лапласа:
	\[
		\begin{aligned}
			 & \Prob\left(k_1\leq \mu_{n} \leq  k_2\right)
			\approx \Phi\left(\frac{k2-np}{\sqrt{np\left(1-p_i\right)}}\right)
			- \Phi\left(\frac{k1-np}{\sqrt{np\left(1-p_i\right)}}\right)
			\\
			 & \text{где } \Phi(x) = \frac{1}{\sqrt{2\pi}} \int_{-\inf}^{x} \exp\left(-\frac{t^2}{2}\right) \,dt
			\\
		\end{aligned}
	\]

	\[
		\begin{aligned}
			\Prob\left(\mu_{2000} \leq  3\right) &
			\approx \Phi\left(\frac{3-\frac{4}{3}}{\sqrt{\frac{4}{3} \cdot \frac{2}{3}}}\right) - \Phi\left(\frac{0-\frac{4}{3}}{\sqrt{\frac{4}{3} \cdot \frac{2}{3}}}\right)
			= \Phi\left(\frac{5}{3 \cdot \sqrt{2}}\right) - \Phi\left(\frac{-4}{3 \cdot \sqrt{2}}\right) \approx
			\\ &
			\approx \Phi\left(1,17\right) - \Phi\left(-0,94\right)
			= \Phi\left(1,17\right) - 1 + \Phi\left(0,94\right)
			\approx 0,8790 - 1 + 0,8264 = 0,7054.
		\end{aligned}
	\]
	Для достоверности посчитаем эту сумму используя ВольфрамАльфа
	\[
		\Prob\left(\mu_{2000} \leq  3\right) = 0,9535.
	\]

	Видно, что формула Пуассона даёт лучшее приближение, чем формула Муавра-Лапласа.
\end{proof}